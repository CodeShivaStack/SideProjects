Perfect ğŸ‘
Weâ€™ll update your contact form to use Supabase, the same clean & correct pattern we used for booking â€” no extra redeclarations, no errors.

âœ… STEP 1: Create contacts table in Supabase

Run this in Supabase â†’ SQL Editor:

create table if not exists contacts (
  id uuid default gen_random_uuid() primary key,
  name text not null,
  email text not null,
  phone text,
  subject text,
  message text not null,
  created_at timestamp default now()
);

alter table contacts enable row level security;

create policy "Public contact insert"
on contacts
for insert
to anon
with check (true);


âœ” Public can insert
âœ” No one can read unless you allow it later

âœ… STEP 2: Make sure Supabase client exists ONLY ONCE

You should already have this (do NOT duplicate it):

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const supabaseClient = supabase.createClient(
    "YOUR_SUPABASE_URL",
    "YOUR_ANON_KEY"
  );
</script>

âœ… STEP 3: Replace ONLY the JS submit logic
âŒ REMOVE this (old API)
const response = await fetch('https://dash.vimalresort.com/api/enquiries', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify(data)
});

âœ… UPDATED CONTACT FORM SUBMIT (Supabase)
document.getElementById('contactForm').addEventListener('submit', async (e) => {
  e.preventDefault();

  const submitBtn = e.target.querySelector('button[type="submit"]');
  const submitText = document.getElementById('submitText');
  const submitSpinner = document.getElementById('submitSpinner');

  submitBtn.disabled = true;
  submitText.textContent = 'Sending...';
  submitSpinner.classList.remove('hidden');

  const formData = Object.fromEntries(new FormData(e.target));

  const { error } = await supabaseClient
    .from('contacts')
    .insert([{
      name: formData.name,
      email: formData.email,
      phone: formData.phone,
      subject: formData.subject,
      message: formData.message
    }]);

  if (error) {
    console.error(error);
    showToast(
      'Something went wrong. Please try again or call us directly.',
      'error'
    );
  } else {
    showToast(
      'Message sent successfully! We will get back to you soon.',
      'success'
    );
    e.target.reset();
  }

  submitBtn.disabled = false;
  submitText.textContent = 'Send Message';
  submitSpinner.classList.add('hidden');
});

âœ… THATâ€™S IT â€” WHAT YOU HAVE NOW

âœ” Booking form â†’ Supabase
âœ” Contact form â†’ Supabase
âœ” No backend server
âœ” No JSON files
âœ” Netlify-ready
âœ” Free & scalable

ğŸ” NEXT IMPORTANT STEP (Strongly Recommended)

Right now:

Anyone can insert

Admin data is not protected yet

Next steps I can help with:

1ï¸âƒ£ Secure admin dashboard (Supabase Auth)
2ï¸âƒ£ Build admin UI for bookings & contacts
3ï¸âƒ£ Email / WhatsApp notifications
4ï¸âƒ£ Export data (CSV / JSON)
5ï¸âƒ£ Rate-limit spam submissions

Tell me what you want next ğŸš€
























Perfect â€” your form UI is already solid ğŸ‘
Weâ€™ll only replace the backend part and wire it directly to Supabase, without breaking your modal, animations, or styles.

Below is a drop-in Supabase integration tailored to your exact code.

âœ… What Weâ€™ll Do

Remove custom API calls (dash.vimalresort.com)

Insert booking data directly into Supabase

Keep everything free

Minimal JS changes

Ready for Netlify deployment

ğŸŸ¢ STEP 1: Update Supabase Table (match your form)

Run this in Supabase â†’ SQL Editor:

create table if not exists bookings (
  id uuid default gen_random_uuid() primary key,
  name text not null,
  phone text not null,
  date date not null,
  rooms int,
  guests int,
  created_at timestamp default now()
);

Enable public insert
alter table bookings enable row level security;

create policy "Public booking insert"
on bookings
for insert
to anon
with check (true);

ğŸŸ¢ STEP 2: Add Supabase Client (ONCE)

Add this before your existing <script> (or at top of it):

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const supabase = supabase.createClient(
    "YOUR_SUPABASE_URL",
    "YOUR_PUBLIC_ANON_KEY"
  );
</script>


ğŸ” These are safe to use on frontend.

ğŸŸ¢ STEP 3: Replace ONLY the Submit Logic
âŒ REMOVE this part
const res = await fetch('https://dash.vimalresort.com/api/bookings', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify(data)
});

âœ… REPLACE with Supabase Insert
document.getElementById('bookingForm').addEventListener('submit', async (e) => {
  e.preventDefault();

  const formData = Object.fromEntries(new FormData(e.target));

  const { error } = await supabase
    .from('bookings')
    .insert([{
      name: formData.name,
      phone: formData.phone,
      date: formData.date,
      rooms: Number(formData.rooms),
      guests: Number(formData.guests)
    }]);

  if (error) {
    console.error(error);
    showToast('Booking failed. Please try WhatsApp.', 'error');
  } else {
    showToast('Booking request sent successfully!', 'success');
    e.target.reset();
    closeBookingModal();
  }
});


âœ… Done â€” booking is now stored in Supabase.

ğŸŸ¢ STEP 4: (Optional) Date Availability Check

If you want to block fully booked dates, hereâ€™s a Supabase-based version.

Example rule: max 10 bookings per day
document.getElementById('bookingDate').addEventListener('change', async function () {
  const date = this.value;

  const { count, error } = await supabase
    .from('bookings')
    .select('*', { count: 'exact', head: true })
    .eq('date', date);

  if (error) {
    showToast('Availability check failed.', 'error');
    return;
  }

  if (count >= 10) {
    showToast('Selected date is fully booked.', 'error');
    this.value = '';
  } else {
    showToast('Date available ğŸ‰', 'success');
  }
});


You can change 10 to any limit.

ğŸŸ¢ STEP 5: Admin Dashboard (Read Bookings)

Create admin.html:

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const supabase = supabase.createClient(
  "YOUR_SUPABASE_URL",
  "YOUR_PUBLIC_ANON_KEY"
);

async function loadBookings() {
  const { data, error } = await supabase
    .from('bookings')
    .select('*')
    .order('created_at', { ascending: false });

  console.log(data);
}

loadBookings();
</script>


You can render this into tables/cards easily.

ğŸ” IMPORTANT SECURITY (DO THIS NEXT)

Right now:

Anyone can insert bookings (good)

Anyone can read bookings (bad)

Fix:

Disable public SELECT

Protect admin page using:

Supabase Auth or

Netlify password protection

I can set this up for you cleanly.

ğŸ¯ Result

âœ” No server
âœ” No .json file
âœ” 100% free
âœ” Netlify compatible
âœ” Scalable
âœ” Secure

Want next?

I can:
1ï¸âƒ£ Secure admin dashboard
2ï¸âƒ£ Create booking table UI
3ï¸âƒ£ Add contact form (same pattern)
4ï¸âƒ£ Add email / WhatsApp notifications
5ï¸âƒ£ Optimize Supabase policies

Just tell me whatâ€™s next ğŸš€